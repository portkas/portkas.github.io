---
title: Vim
categories:
    - Linux
---
# 安装
```bash
# 安装
$ sudo apt install vim

# 查看版本
$ vim --version
```
<!-- more -->
# vim模式简介
* 命令模式：查看文件内容，修改文件，关键词条的搜索
* 编辑模式：修改文件内容
* 末行模式：执行Linux命令，保存文件，行跳转，窗口分屏

# 命令模式
## 保存和退出
连续按两个大写的Z，即`ZZ`可在命令行模式下，保存并退出文件，等同于末行模式下的`:wq`

## 代码标准化
命令模式下，直接通过键盘输入`gg=G`，即可对代码进行标准化，使得代码排版更加工整。

## 光标移动
|快捷键|功能|备注|
|:---:|:---|:---|
|0|光标移动到行首|无|
|$|光标移动到行尾|无|
|gg|光标移动到文件头|第一行的开始|
|G|光标移动到文件尾|最后一行的开始|
|nG|行跳转|n代表要跳转到哪行|
|n+回车|相对跳转n行|从光标开始处往下跳转n行|

## 删除命令
vim中没有删除操作，删除即剪切，剪切后可复制到其他地方。
|快捷键|功能|备注|
|:---:|:---:|:---:|
|x|删除光标后面的单个字符|无|
|X|删除光标前面的单个字符|无|
|dw|删除单词|要把光标移动到单词的第一个字母上|
|d0|删除光标前的字符串|光标所在行前面的字符全部删除|
|dD($)|删除光标后面的字符串|dD 和 d$ 功能一样|
|dd|删除光标所在行|无|
|ndd|删除n行|从光标开始往下删除n行|

## 撤销和反撤销
|快捷键|功能
|:---:|:---:|
|u|撤销|
|ctrl+r|反撤销|

## 复制和粘贴
|快捷键|功能|
|:---:|:---:|
|yy|复制光标所在行|
|nyy|从光标所在行向下复制n行|
|p|粘贴到光标所在行的下面|
|P|粘贴到光标所在行的上面|

## 可视模式
* v：进入字符可视模式，文本以字符为单位
* V：进入行可视模式，文本以行为单位
* ctrl+v：进入块可视模式，可以选择一个矩形内的文本

|快捷键|功能|备注|
|:---:|:---:|:---:|
|d|删除（剪切）|删除可视模式下的可视块|
|y|复制|复制可视模式下选中的数据块|
|p|数据粘贴到光标的后面|无|
|P|数据粘贴到光标的前面|无|

### 代码块注释
1.通过`ctrl+v`进入块可视模式
2.移动光标选中多行代码开头
3.选择完毕后，输入大写的`I`进入`insert`模式
4.输入要插入的注释符`//`
5.按ESC键退出

## 替换
|快捷键|功能|备注|
|:---:|:---:|:---:|
|r|替换光标后的单个字符|无|
|R|替换光标后的多个字符|按ESC结束替换|

## 查找
|搜索快捷键|关键字遍历|描述|备注|
|:---:|:---|:---:|:---:|
|/|n|从当前位置向下|无|
| |N|从当前位置向上|无|
|?|n|从当前位置向上|无|
| |N|从当前位置向下|无|
|#|n|从当前位置向上|光标当在需要搜索的关键字上按`#`|
| |N|从当前位置向下|无|

## 切换到编辑模式
|快捷键|功能|
|:---:|:---:|
|i|从光标前面开始输入|
|o|在光标下面创建新行，并从新行开始输入|
|O|在光标上面创建新行，并从新行开始输入|
|A|从当前行行尾开始输入|
|S（大写S）|删除当前行，在当前行开始输入|
|a|从光标的后面开始输入|
|s（小写s）|删除光标盖住的字符，并开始输入|
|I（大写i）|从当前行行首开始输入|

# 末行模式
## 保存和退出
|末行模式下输入的命令|功能|
|:---:|:---:|
|q|退出|
|q!|直接退出不保存|
|w|保存不退出|
|wq|保存并退出|
|x|保存并退出|

## 替换
|末行模式下输入的命令|说明|
|:---:|:---:|
|s/被替换的关键字/新的关键字/g|只对光标所在行进行替换|
|行号1,行号2 s/被替换关键字/新的关键字/g|替换行号1-行号2之间的关键字|
|%s/被替换的关键字/新的关键字/g|替换所有关键字|

## 分屏
|末行模式下输入的命令|说明|
|:---:|:---:|
|sp|水平分屏，上下两个屏|
|vsp|垂直分屏，左右两个屏|
|ctrl+w+w|光标在打开的屏幕之间切换|
|qall|同时退出所有屏幕|
|wqall|保存并退出所有屏幕|
|sp 文件名|分屏的同时，打开指定文件|
|vsp 文件名|分屏的同时，打开指定文件|

vim打开多个文件的时候，可以分屏打开
```bash
# 水平分屏，上下两个屏
$ vim -o file1 file2

# 垂直分屏，左右两个屏
$ vim -O file1 file2
```

## 执行shell命令（:!）
```
:!shell命令
:!ls
```

# vim配置文件
* 用户级别的配置文件：`~/.vimrc`
* 系统级别的配置文件：`/etc/vim/vimrc`
